# Plan Structure Guide (Table-Based)

> **Edit history:** All normative changes to this guide are documented in its [Plan Structure Guide Edits Registry](../registry/plan_structure_guide/plan_structure_edits_registry.md).

## ðŸš¦ MANDATORY ENTRYPOINT
**All planning, logic, and critical rules start from [AI_ASSISTANT_GUIDELINES.md](./AI_ASSISTANT_GUIDELINES.md).**

- This guide is only for plan structure and template logic.
- For general assistant logic, always refer to the entrypoint first.

## âš ï¸ OBLIGATORY PLAN TEMPLATE
**All plans MUST use the [PLAN_HANDOVER_TEMPLATE.md](./PLAN_HANDOVER_TEMPLATE.md) as the only valid structure.**

- Any plan not following this template is INVALID and must be regularized immediately.
 - The table structure is defined in the template, not here. This guide only explains the logic, numbering, and best practices for using the template.
 - For the actual table, see the template: [PLAN_HANDOVER_TEMPLATE.md](./PLAN_HANDOVER_TEMPLATE.md).

## Minimum Plan Structure

- Steps are numbered for the main flow; incidentals or transversal findings use letters (A, B, C, ...).
- All evidence, discussions, or detailed logs must be kept in external files and linked from the table in the plan.
- The plan must remain clean, with only the table and essential context.

## Actionable Steps Principle

All steps in a plan must be clear, concrete, and directly executable by any contributor, without requiring further clarification. Avoid ambiguity and open-ended instructions.

**Guidelines:**
- Each step should specify exactly what to do (e.g., command to run, file to edit, output to check).
- If there are options, list them explicitly and describe how to choose.
- Avoid vague language like "analyze", "review", or "as needed" unless followed by a concrete action.
- Use the table for all actionable items (see template).

**Examples:**
- Good: `Edit the configuration file to set the required parameter.`
- Good: `Update the documentation to include the new process step.`
- Good: `If an error occurs, create a log file and link it in the table.`
- Bad: `Test the process` (too vague)
- Bad: `Review the output` (what is the expected output? what to do if it fails?)

## Best Practices
- Keep steps actionable and verifiable.
- Update the plan as you learn or as requirements change.
- Use error logs and validation evidence for traceability (always linked from the table).
- Always close the plan with a summary and links to evidence.
- Propose improvements to this guide or templates as needed.

## Plan Closure

All plans must be formally closed following these steps:
- Ensure all table steps are complete and validated.
- Attach or link all evidence (logs, outputs, screenshots, etc.) in the Related column.
- Summarize key learnings and decisions.
- **Verify that all permanent documentation and artifacts are written in ENGLISH, as required by the LANGUAGE_POLICY_GUIDE.md. Plans or files in Spanish must be translated before archiving.**
- **Before any commit (closure, archive, or autonomous action), ALWAYS run `git status` to review and confirm only relevant files are staged.**
- **After deleting all temporary files, also remove any empty folders associated with closed plans in `private/`, leaving only `planning/` and other active folders as needed.**
- Archive the plan if it has long-term value, or delete if not needed (see archiving policy).
- Remove all temporary/intermediate files unless needed for traceability.
- If minor tasks remain, create a mini-plan and close the main one.
 - Reference the [PLAN_HANDOVER_TEMPLATE.md](./PLAN_HANDOVER_TEMPLATE.md) for closure instructions and required sections.

## Bidirectional Traceability Policy
- Every step in the plan must link to its corresponding log, and every log must link back to the plan.
- Any artifact (log, template, evidence, etc.) generated by a log must link back to the log, and the log must register the link to the artifact.
- This ensures complete traceability and auditability across all documentation and actions.

**Example:**
- In the plan table: | Step | Description | Status | Notes | Related |
  - Related: [log_step4_example.md] (example log file, not an actual file)
- In the log: â€œThis log is linked to the plan step 4. Artifact generated: [GUIDE_LOGIC_TEST_TEMPLATE.md] (example artifact, not an actual file)â€
- In the artifact: â€œThis template was generated by [log_step4_example.md] (example log, not an actual file)â€

## Relationship to Other Templates
- [AI_ASSISTANT_GUIDELINES.md](./AI_ASSISTANT_GUIDELINES.md) â€” **MANDATORY ENTRYPOINT**
- [PLAN_HANDOVER_TEMPLATE.md](./PLAN_HANDOVER_TEMPLATE.md) â€” **MANDATORY PLAN TEMPLATE**
- [VALIDATION_LOG_TEMPLATE.md](./VALIDATION_LOG_TEMPLATE.md) â€” Optional, for documenting validation results.
- [ERROR_HANDLING_ENTRY_TEMPLATE.md](./ERROR_HANDLING_ENTRY_TEMPLATE.md) â€” Optional, for error handling logs.

## Cleaning up `private/` and Temporary Artifacts

To ensure a clean and auditable workspace, always perform the following before closing or archiving a plan:

- Delete all temporary, intermediate, or test files generated during the plan (e.g., migration scripts, test notebooks, intermediate logs).
- Remove any empty folders in `private/` that are not required for active or archived plans.
- Only keep final evidence, validated logs, and essential documentation.
- Confirm all documentation and artifacts to be archived are in ENGLISH, as required by the LANGUAGE_POLICY_GUIDE.md. Translate or summarize as needed.
- Use `git status` to verify only relevant files are staged for commit.

**Example checklist for cleaning up:**
- [ ] Remove files in `temp_notebooks/`, `private/plan_logs/` not referenced in the plan table.
- [ ] Delete migration or test scripts no longer needed.
- [ ] Remove intermediate logs or outputs not linked as evidence.
- [ ] Delete empty folders in `private/`.
- [ ] Ensure all remaining files are in English and relevant for traceability.

> For questions or improvements, propose changes directly in this guide or via the main AI Assistant Guidelines.
